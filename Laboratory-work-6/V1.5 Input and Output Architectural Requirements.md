# Шпаргалка про випадки зловживання

## Вступ

Часто, коли у вимогах згадується рівень безпеки програми, зустрічаються такі *вирази*:

- *Програма має бути безпечною*.
- *Програма повинна захищатися від усіх атак, спрямованих на цю категорію програм*.
- *Програма повинна захищатися від атак з OWASP TOP 10*
- ...

Ці вимоги безпеки надто загальні, а отже, марні для команди розробників...

Щоб побудувати безпечну програму, з прагматичної точки зору, важливо визначити атаки, від яких програма повинна захищатися, відповідно до її бізнес-технічного контексту.

### Мета

Мета цієї шпаргалки — надати пояснення того, що таке **випадок зловживання**, чому випадки зловживання важливі для безпеки програми та, нарешті, надати пропозицію щодо прагматичного підходу до створення списку випадки зловживання та відстеження їх для кожної функції, запланованої для реалізації як частини програми. Шпаргалку можна використовувати для цієї мети незалежно від використовуваної методології проекту (водоспад або гнучка).

**Важлива примітка щодо цієї шпаргалки:**

```текст
Основна мета полягає в тому, щоб забезпечити прагматичний підхід, щоб дозволити компанії або команді проекту
щоб розпочати створення та обробку списку випадків порушення, а потім налаштувати елементи
запропонував її контексту/культурі, щоб, нарешті, побудувати власний метод.

Цю шпаргалку можна розглядати як посібник із початку роботи.
```

### Контекст і підхід

#### Навіщо чітко ідентифікувати атаки

Чітке визначення атак, від яких має захищатися програма, має важливе значення для виконання наступних кроків у проекті чи спринті:

- Оцініть бізнес-ризик для кожної з ідентифікованих атак, щоб зробити вибір відповідно до бізнес-ризику та бюджету проекту/спринту.
- Отримайте вимоги безпеки та додайте їх у специфікацію проекту або історії користувачів спринту та критерії прийняття.
- Оцініть накладні витрати в початковій платі за проект/спринт, які будуть необхідні для впровадження контрзаходів.
- Про контрзаходи: дозвольте команді проекту визначити їх і визначити, у якому місці вони доречні (мережа, інфраструктура, код...).

#### Поняття справи про зловживання

Щоб допомогти створити список атак, корисно поняття **Випадки зловживань**.

**Випадок зловживання** можна визначити як:

```текст
Спосіб використання функції, яка не очікувалася розробником,
дозволяючи зловмиснику впливати на функцію або результат використання
функція, заснована на дії (або введенні) зловмисника.
```

Synopsys визначає **Випадок зловживання** так:

```текст
Випадки зловживання та зловживання описують, як користувачі зловживають або використовують слабкі місця
елементів керування в функціях програмного забезпечення для атаки на програму.

Це може призвести до відчутного впливу на бізнес у разі прямої атаки
бізнес-функції, які можуть приносити дохід або надавати
позитивний досвід користувача, піддаються нападам.

Випадки зловживань також можуть бути ефективним способом підвищення вимог безпеки
які призводять до належного захисту цих важливих бізнес-випадків використання.
```

[Джерело Synopsys](https://www.synopsys.com/blogs/software-security/abuse-cases-can-drive-security-requirements)

#### Як визначити список випадків зловживання

Існує багато різних способів визначити список випадків зловживань для функції (який можна зіставити з історією користувача в гнучких проектах).

Проект [OWASP Open SAMM](https://owasp.org/www-project-samm/) пропонує наступний підхід у *потоці B* практики безпеки *тестування на основі вимог* для рівня зрілості 2:

```текст
Випадки неправильного використання та зловживання описують сценарії ненавмисного та зловмисного використання програми, описуючи, як зловмисник міг це зробити. Створюйте випадки зловживань і зловживань, щоб зловживати або використовувати слабкі місця елементів керування в функціях програмного забезпечення для атаки на програму. Використовуйте моделі випадків зловживання для програми, щоб служити джерелом для виявлення конкретних тестів безпеки, які прямо чи опосередковано використовують сценарії зловживання.

Зловживання функціональними можливостями, яке іноді називають «атакою на бізнес-логіку», залежить від дизайну та реалізації функцій і функцій програми. Прикладом є використання потоку скидання пароля для перерахування облікових записів. У рамках тестування бізнес-логіки визначте бізнес-правила, важливі для програми, і перетворіть їх на експерименти, щоб перевірити, чи програма належним чином виконує бізнес-правила. Наприклад, у додатку для торгівлі акціями, чи дозволено зловмиснику почати торгівлю на початку дня та зафіксувати ціну, утримувати транзакцію відкритою до кінця дня, а потім завершити продаж, якщо ціна акцій зросла чи скасувати, якщо ціна впала?
```

Відкрите джерело SAMM: [Потік B тестування на основі вимог перевірки](https://owaspsamm.org/model/verification/requirements-driven-testing/stream-b/)

Іншим способом створення списку може бути наступний (більш висхідний і орієнтований на співпрацю):

Створіть майстерню, яка включає людей із такими профілями:

- **Бізнес-аналітик**: будуть ключовими людьми, які описуватимуть кожну функцію з точки зору бізнесу.
- **Аналітик ризиків**: буде персоналом ризиків компанії, який оцінюватиме бізнес-ризик від запропонованої атаки (іноді це **Бізнес-аналітик** залежно від компанії).
- **Тестер проникнення**: буде *зловмисник*, який запропонує атаки, які вони можуть здійснити на бізнес-функції, про які йдеться. Якщо в компанії немає людини з таким профілем, то можна запросити послугу стороннього спеціаліста. Якщо можливо, додайте 2 тестувальників на проникнення з різним досвідом, щоб збільшити кількість можливих атак, які будуть виявлені та розглянуті.
- **Технічні керівники проектів**: будуть технічними спеціалістами проекту та дозволятимуть технічний обмін інформацією про атаки та контрзаходи, виявлені під час семінару.
- **Аналітик із забезпечення якості або функціональний тестувальник**: персонал, який може добре розуміти, як програма/функціонал має працювати (позитивне тестування), не працювати (негативне тестування) і що спричиняє його збій (збій). випадків).

Під час цього семінару (тривалість залежатиме від розміру списку функцій, але 4 години є хорошим початком) будуть опрацьовані всі бізнес-функції, які будуть частиною проекту або спринту. Результатом семінару буде список атак (випадків зловживання) для всіх бізнес-функцій. Усі випадки зловживань матимуть рейтинг ризику, який дозволяє фільтрувати та пріоритезувати.

Важливо взяти до уваги **Технічні** та **Бізнес** випадки зловживань і позначити їх відповідним чином.

*Приклад:*

- Технічно позначений випадок порушення: додайте впровадження міжсайтового сценарію в поле введення коментаря.
- Випадок зловживання, позначеного бізнесом: можливість довільно змінювати ціну товару в онлайн-магазині до того, як прийняти замовлення, змусивши користувача заплатити меншу суму за потрібний товар.

#### Коли визначати список випадків порушення

У гнучких проектах семінар з визначення має проводитися після наради, під час якої Історії користувачів включаються в спринт.

У каскадних проектах семінар з визначення повинен бути проведений, коли бізнес-функції, які потрібно реалізувати, визначені та відомі компанії.

Незалежно від використовуваного режиму проекту (гнучкий чи каскадний), випадки зловживань, вибрані для розгляду, мають стати вимогами безпеки в кожному розділі специфікації функцій (какад) або критеріями прийнятності Історії користувача (гнучкий), щоб забезпечити додаткову оцінку витрат/зусиль, ідентифікацію та впровадження контрзаходів.

Кожен випадок порушення повинен мати унікальний ідентифікатор, щоб можна було відслідковувати протягом усього проекту/спринту (деталі щодо цього моменту буде надано в розділі пропозиції).

Прикладом формату унікального ідентифікатора може бути **ABUSE_CASE_001**.

На наступному малюнку наведено огляд ланцюжка різних етапів (зліва направо):

![Оглядова схема](../assets/Abuse_Case_Cheat_Sheet_Overview.png)

### Пропозиція

Пропозиція буде зосереджена на результатах семінару, пояснених у попередньому розділі.

#### Крок 1: Підготовка семінару

По-перше, навіть якщо це здається очевидним, ключові ділові люди повинні бути впевнені, що знають, розуміють і вміють пояснити особливості бізнесу, які будуть опрацьовані під час семінару.
По-друге, створіть новий файл Microsoft Excel (ви також можете використовувати Google Sheets або будь-яке інше подібне програмне забезпечення) з такими аркушами (або вкладками):

- **ОСОБЛИВОСТІ**
    - Містить таблицю з переліком бізнес-функцій, запланованих для семінару.
- **ВИПАДКИ ЗЛОВЖИВАННЯ**
    - Містить таблицю з усіма випадками зловживання, виявленими під час семінару.
- **КОНТРОЗАХОДИ**
    - Містить таблицю зі списком можливих контрзаходів (легкий опис), уявлених для виявлених випадків зловживання.
    - Цей аркуш не є обов’язковим, але він може бути корисним (для ознайомлення з випадком порушення), якщо виправлення легко впровадити, і воно може вплинути на рейтинг ризику.
    - Контрзаходи можуть бути визначені за допомогою профілю AppSec під час семінару, тому що співробітник AppSec повинен вміти виконувати атаки, а також створювати або ідентифікувати захист (це не завжди стосується профілю Pentester, оскільки ця особа, як правило, зосереджена на атаці лише збоку, тому комбінація Pentester + AppSec дуже ефективна для огляду на 360 градусів).

Це представлення кожного аркуша разом із прикладом вмісту, який буде заповнено під час семінару:

Аркуш *ХАРАКТЕРИСТИКИ*:

| Унікальний ідентифікатор функції | Назва функції | Короткий опис функції |
|:-----------------:|:---------------------:|:---- ----------------------------------------------:|
| FEATURE_001 | DocumentUploadFeature | Дозволити користувачеві завантажувати документ разом із повідомленням |

аркуш *КОНТРОЗАХОДИ*:

| Унікальний ID контрзаходу | Протидія короткий опис | Допомога/підказка щодо контрзаходів |
|--------------------------|-------------------- ----------------------------------|-------------- ----------------------------------------------|
| ЗАХИСТ_001 | Перевірте завантажений файл, завантаживши його в аналізатор | Скористайтеся порадами зі шпаргалки OWASP щодо завантаження файлів |

Аркуш *ВИПАДКИ ЗЛОВЖИВАННЯ*:

| Унікальний ідентифікатор випадку порушення | Ідентифікатор функції порушено | Опис атаки випадку порушення | Посилальний ідентифікатор атаки (якщо застосовно) | Рейтинг ризику CVSS V3 (бал) | Рядок CVSS V3 | Вид випадку зловживання | Контрзахід ID застосовується | Рішення про обробку (вирішувати або прийняти ризик) |
|:--------------------:|:-------------------:|:--- -------------------------------------------------- ------------------:|:------------------------------ --------:|:---------------------------:|:--------- ----------------------------------:|:----------- ------:|:------------------------------:|:---------- ------------------------------------:|
| ABUSE_CASE_001 | FEATURE_001 | Завантажте файл Office зі зловмисним макросом, відповідальним за видалення зловмисного програмного забезпечення | CAPEC-17 | ВИСОКИЙ (7,7) | CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:H/A:H | Технічні | ЗАХИСТ_001 | За адресою |

#### Крок 2: Під час семінару

Використовуйте електронну таблицю, щоб переглянути всі функції.

Для кожної функції дотримуйтесь цієї послідовності:

1. Ключові бізнесмени пояснюють поточну функцію з точки зору бізнесу.
2. Тестери проникнення пропонують і пояснюють набір атак, які вони можуть здійснити проти функції.
3. Для кожної запропонованої атаки:
    1. Appsec пропонує контрзахід і бажане місце встановлення (інфраструктура, мережа, код, дизайн...).
    2. Технічні спеціалісти надають відгук про здійсненність запропонованого контрзаходу.
    3. Тестери проникнення використовують калькулятор CVSS v3 (або інший стандартний) для визначення рейтингу ризику. (наприклад: [калькулятор CVSS V3](https://www.first.org/cvss/calculator/3.0))
    4. Ключові особи ризику приймають/підвищують/зменшують рейтинг, щоб мати остаточний рейтинг, який відповідає реальному впливу на бізнес компанії.

4. Ключові особи з бізнесу, ризиків і технічних питань знаходять консенсус і фільтрують список зловживань для поточної функції, щоб залишити ті, які потрібно усунути, а потім позначають їх відповідно на аркуші *ВИПАДКИ ЗЛОВЖИВАННЯ* (**якщо ризик прийнято потім додайте коментар, щоб пояснити, чому**).
5. Перейти до наступної функції...
   Якщо присутність тестувальників проникнення неможлива, ви можете скористатися наведеними нижче посиланнями, щоб визначити відповідні атаки на ваші функції:

- [Автоматизовані загрози OWASP для веб-програм](https://owasp.org/www-project-automated-threats-to-web-applications/)
- [Посібник з тестування OWASP](https://owasp.org/www-project-web-security-testing-guide/stable/)
- [Посібник з мобільного тестування OWASP](https://github.com/OWASP/owasp-mstg)
- [Загальний перелік і класифікація шаблонів атак (CAPEC)](https://capec.mitre.org/)

Важлива примітка щодо бази знань про атаки та контрзаходи:

```текст
З часом і в різних проектах ви отримаєте власний словник атак і заходів протидії
які можна застосувати до типу програми у домені вашого бізнесу.

Цей словник суттєво пришвидшить майбутні семінари.

Щоб сприяти створенню цього словника, ви можете наприкінці проекту/спринту зібрати список
атак і контрзаходів, визначених у центральному місці (вікі, база даних, файл...), які будуть
використовувався під час наступного семінару в поєднанні з даними від докучників проникнення.
```

#### Крок 3: Після семінару

Електронна таблиця містить (на цьому етапі) перелік усіх випадків зловживань, які необхідно розглянути, і потенційно (залежно від можливостей) відповідні контрзаходи.

Тепер залишилося два завдання:

1. Ключові бізнесмени повинні оновити специфікацію кожної функції (какад) або історію користувача кожної функції (гнучкість), щоб включити пов’язані випадки зловживань як Вимоги безпеки (каскад) або Критерії прийнятності (гнучкість).
2. Ключові технічні працівники повинні оцінити накладні витрати з точки зору заряду/зусиль, щоб врахувати контрзахід.

#### Крок 4: під час впровадження – відстеження випадків порушення

Для відстеження розгляду всіх випадків зловживань можна використовувати наступний підхід:

Якщо одна або декілька справ про зловживання розглядаються за адресою:

- **Рівень дизайну, інфраструктури або мережі**
    - Зробіть примітку в документації або схемі, щоб вказати, що *цей дизайн/мережа/інфраструктура враховує випадки зловживання ABUSE_CASE_001, ABUSE_CASE_002, ABUSE_CASE_xxx*.
- **Рівень коду**
    - Додайте спеціальний коментар до класів/сценаріїв/модулів, щоб вказати, що *Цей клас/модуль/сценарій враховує випадки зловживання ABUSE_CASE_001, ABUSE_CASE_002, ABUSE_CASE_xxx*.
    - Спеціальну анотацію, наприклад `@AbuseCase(ids={"ABUSE_CASE_001","ABUSE_CASE_002"})` можна використовувати для полегшення відстеження та ідентифікації в інтегрованому середовищі розробки.

Використовуючи цей спосіб, стає можливим (за допомогою деяких незначних сценаріїв) визначити, де розглядаються випадки зловживання.


#### Крок 5: Під час впровадження - Перевірка випадків порушення

Коли визначено випадки зловживання, можна запровадити автоматичну або ручну перевірку, щоб переконатися, що:

- Усі вибрані випадки зловживань розглядаються.
- Справа про зловживання розглядається правильно/повністю.

Перевірки можуть бути таких видів:

- Автоматизовано (регулярно запускати під час фіксації, щодня або щотижня в завданнях безперервної інтеграції проекту):
    - Спеціальні правила аудиту в інструментах статичного тестування безпеки додатків (SAST) або динамічного тестування безпеки додатків (DAST).
    - Тести спеціального блоку, інтеграції або функціональної безпеки.
    - ...
- Інструкція:
    - Перегляд коду безпеки між однолітками проекту під час проектування або реалізації.
    - Надайте перелік усіх випадків зловживань, адресованих пентестерам, щоб вони могли перевірити ефективність захисту для кожного випадку зловживання під час тесту на вторгнення до програми (пентестер перевірить, що виявлені атаки більше не є ефективними, а також спробує знайти інші можливі напади).
    - ...

Додавання автоматизованих тестів також дозволяє командам відстежувати, чи ефективні/активні контрзаходи проти випадків зловживання під час етапу обслуговування або виправлення помилок проекту (щоб запобігти випадковому видаленню/вимкненню). Це також корисно, коли використовується підхід [Безперервної доставки](https://continuousdelivery.com/), щоб переконатися, що всі випадки зловживань задіяні, перш ніж відкривати доступ до програми.

### Приклад виведення випадків зловживань як історій користувачів

У наступному розділі наведено приклад створення випадків зловживань як історій користувачів із використанням [OWASP TOP 10](https://owasp.org/www-project-top-ten/) як джерела вхідних даних.

Персони, орієнтовані на загрозу:

- Зловмисний користувач
- Образливий користувач
- Невідомий користувач

#### A1:2017-Ін'єкція

*Епічно:*

Майже будь-яке джерело даних може бути вектором ін’єкції, змінними середовища, параметрами, зовнішніми та внутрішніми веб-службами та всіма типами користувачів. [Injection](https://owasp.org/www-community/Injection_Flaws) недоліки виникають, коли зловмисник може надіслати ворожі дані інтерпретатору.

*Випадок зловживання:*

Як зловмисник я здійсню ін’єкційну атаку (запити SQL, LDAP, XPath або NoSQL, команди ОС, аналізатори XML, заголовки SMTP, мови виразів і запити ORM) проти полів введення інтерфейсів користувача або API

#### A2:2017-Порушена автентифікація

*Епічно:*

Зловмисники мають доступ до сотень мільйонів дійсних комбінацій імен користувачів і паролів для введення облікових даних, списків адміністративних облікових записів за замовчуванням, автоматизованого підбору та інструментів атаки за словником. Атаки на керування сеансами добре зрозумілі, особливо щодо маркерів сеансу, термін дії яких закінчився.

*Випадок зловживання:*

Як зловмисник, я маю доступ до сотень мільйонів дійсних комбінацій імені користувача та пароля для введення облікових даних.

*Випадок зловживання:*

Як зловмисник, у мене є списки адміністративних облікових записів за замовчуванням, автоматична груба сила та інструменти атаки за словником, які я використовую проти областей входу додатків і систем підтримки.

*Випадок зловживання:*

Як зловмисник, я маніпулюю маркерами сеансу, використовуючи прострочені та підроблені маркери, щоб отримати доступ.

#### A3: 2017 - Розкриття конфіденційних даних

*Епічно:*

Замість того, щоб безпосередньо атакувати криптовалюту, зловмисники викрадають ключі, здійснюють атаки типу «людина посередині» або викрадають чисті текстові дані з сервера під час передачі або з клієнта користувача, наприклад. браузер. Як правило, потрібна ручна атака. Раніше отримані бази даних паролів можуть бути піддані грубій обробці графічним процесором (GPU).

*Випадок зловживання:*

Як зловмисник я викрадаю ключі, які були розкриті в програмі, щоб отримати несанкціонований доступ до програми чи системи.

*Випадок зловживання:*

Як зловмисник, я виконую атаки типу "людина посередині", щоб отримати доступ до трафіку та використовувати його для отримання конфіденційних даних і, можливо, отримати неавторизований доступ до програми.

*Випадок зловживання:*

Як зловмисник я викрадаю чисті текстові дані з сервера під час передачі або з клієнта користувача, напр. браузер, щоб отримати неавторизований доступ до програми або системи.

*Випадок зловживання:*

Як зловмисник, я знаходжу старі або слабкі криптографічні алгоритми та націлюю їх, перехоплюючи трафік і порушуючи шифрування.

#### A4:2017-XML зовнішні сутності (XXE)

*Епічно:*

Зловмисники можуть використовувати вразливі процесори XML, якщо вони можуть завантажити XML або включити ворожий вміст у XML-документ, використовуючи вразливий код, залежності чи інтеграції.

*Випадок зловживання:*

Як зловмисник я використовую вразливі області програми, куди користувач або система можуть завантажувати XML, щоб видобувати дані, виконувати віддалений запит із сервера, сканувати внутрішні системи, виконувати атаку типу «відмова в обслуговуванні», а також виконувати інші атаки .

*Випадок зловживання:*

Як зловмисник я включаю ворожий вміст у XML-документ, який завантажується в програму чи систему, щоб отримати дані, виконати віддалений запит із сервера, сканувати внутрішні системи, виконати атаку типу «відмова в обслуговуванні», а також виконати інші напади.

*Випадок зловживання:*

Як зловмисник, я включаю зловмисний XML-код для використання вразливого коду, залежностей або інтеграцій для отримання даних, виконання віддаленого запиту від сервера, сканування внутрішніх систем, виконання атак типу «відмова в обслуговуванні» (наприклад, атака Billion Laughs), а також як виконувати інші атаки.

#### A5:2017-Порушений контроль доступу

*Епічно:*

Використання контролю доступу є основним навиком зловмисників. Контроль доступу можна виявити за допомогою ручних засобів або, можливо, за допомогою автоматизації за відсутності контролю доступу в певних структурах.

*Випадок зловживання:*

Як зловмисник я обходжу перевірки контролю доступу, змінюючи URL-адресу, внутрішній стан програми чи HTML-сторінки, або просто використовуючи спеціальний інструмент атаки API.

*Випадок зловживання:*

Як зловмисник я маніпулюю первинним ключем і змінюю його, щоб отримати доступ до запису іншого користувача, дозволяючи переглядати або редагувати чужий обліковий запис.

*Випадок зловживання:*

Як зловмисник я маніпулюю сеансами, маркерами доступу чи іншими елементами керування доступом у програмі, щоб діяти як користувач, не ввійшовши в систему, або діяти як адміністратор/привілейований користувач, коли ввійшов як користувач.

*Випадок зловживання:*

Як зловмисник я використовую маніпуляції метаданими, такі як повторне відтворення або підробка маркера керування доступом JSON Web Token (JWT), файлів cookie або прихованих полів, маніпулюваних для підвищення привілеїв або зловживання недійсністю JWT.

*Випадок зловживання:*

Як зловмисник, я використовую неправильну конфігурацію CORS Cross-Origin Resource Sharing, що дозволяє неавторизований доступ до API.

*Випадок зловживання:*

Як зловмисник, я змушую переглядати автентифіковані сторінки як неавтентифікований користувач або привілейовані сторінки як звичайний користувач.

*Випадок зловживання:*

Як зловмисник я отримую доступ до API із відсутніми елементами керування доступом для POST, PUT і DELETE.

*Випадок зловживання:*

Як зловмисник, я націлюсь на криптоключі за замовчуванням, що використовуються, слабкі криптоключі, згенеровані чи повторно використані, або ключі, де відсутня ротація.

*Випадок зловживання:*

Як зловмисник я знаходжу області, де агент користувача (наприклад, програма, поштовий клієнт) не перевіряє, чи дійсний отриманий сертифікат сервера, і здійснюю атаки, у яких я отримую неавторизований доступ до даних.

#### A6:2017-Неправильна конфігурація безпеки

*Епічно:*

Зловмисники часто намагаються використати невиправлені недоліки або отримати доступ до облікових записів за замовчуванням, невикористаних сторінок, незахищених файлів і каталогів тощо, щоб отримати неавторизований доступ або знання системи.

*Випадок зловживання:*

Як зловмисник я знаходжу та використовую відсутність відповідних конфігурацій посилення безпеки в будь-якій частині стеку програм або неправильно налаштовані дозволи в хмарних службах.

*Випадок зловживання:*

Як зловмисник я знаходжу непотрібні функції, які ввімкнено або встановлено (наприклад, непотрібні порти, служби, сторінки, облікові записи чи привілеї), і атакую або використовую слабкість.

*Випадок зловживання:*

Як зловмисник я використовую облікові записи за замовчуванням і їхні паролі для доступу до систем, інтерфейсів або виконання дій з компонентами, які я не повинен мати.

*Випадок зловживання:*

Як зловмисник, я знаходжу області програми, де обробка помилок виявляє трасування стека або інші надто інформативні повідомлення про помилки, які я можу використовувати для подальшої експлуатації.

*Випадок зловживання:*

Як зловмисник я знаходжу області, де оновлені системи, найновіші функції безпеки вимкнені або неналаштовані безпечно.

*Випадок зловживання:*

Як зловмисник я бачу, що налаштування безпеки на серверах додатків, фреймворках додатків (наприклад, Struts, Spring, ASP.NET), бібліотеках, базах даних тощо не мають безпечних значень.

*Випадок зловживання:*

Як зловмисник я вважаю, що сервер не надсилає заголовки безпеки чи директиви або вони не налаштовані на безпечні значення.

#### A7:2017-Міжсайтовий сценарій (XSS)

*Епічно:*

XSS є другою за поширеністю проблемою в топ-10 OWASP і зустрічається приблизно у двох третинах усіх програм.

*Випадок зловживання:*

Як зловмисник, я виконую відображений XSS, де програма або API включає неперевірені та неекрановані дані користувача як частину виведення HTML. Моя успішна атака може дозволити зловмиснику виконати довільний HTML і JavaScript у браузері моєї жертви. Зазвичай жертві потрібно буде взаємодіяти з деяким зловмисним посиланням, яке спрямовує на контрольовану зловмисником сторінку, як-от зловмисні веб-сайти, рекламні оголошення тощо.

*Випадок зловживання:*

Як зловмисник я використовую збережений XSS, де програма або API зберігає несанкціоновані дані користувача, які пізніше переглядає інший користувач або адміністратор.

*Випадок зловживання:*

Як зловмисник я використовую DOM XSS, де фреймворки JavaScript, односторінкові програми та API, які динамічно включають контрольовані зловмисником дані на сторінку, вразливі до DOM XSS.

### A8:2017-Небезпечна десеріалізація

*Епічно:*

Використання десеріалізації є дещо складним, оскільки готові експлойти рідко працюють без змін або налаштувань базового коду експлойтів.

*Випадок зловживання:*

Як зловмисник, я знаходжу області програми та API, де можна забезпечити десеріалізацію ворожих або підроблених об’єктів. У результаті я можу зосередитися на атаках, пов’язаних з об’єктом і структурою даних, де зловмисник змінює логіку програми або досягає довільного віддаленого виконання коду, якщо для програми є доступні класи, які можуть змінювати поведінку під час або після десеріалізації. Або я зосереджую увагу на атаках на підробку даних, таких як атаки, пов’язані з контролем доступу, де використовуються існуючі структури даних, але вміст змінюється.

### A9:2017-Використання компонентів із відомими вразливими місцями

*Епічно:*

Хоча легко знайти вже написані експлойти для багатьох відомих вразливостей, інші вразливості вимагають зосереджених зусиль для розробки спеціального експлойту.

*Випадок зловживання:*

Як зловмисник я знаходжу звичайні пакунки з відкритим або закритим кодом із слабкими місцями та виконую атаки на вразливості та експлойти, які розкриваються

### A10:2017 - Недостатнє ведення журналів і моніторинг

*Епічно:*

Використання недостатньої вирубки та моніторингу є основою майже кожного великого інциденту. Зловмисники покладаються на відсутність моніторингу та своєчасної реакції для досягнення своїх цілей, не будучи виявленими. У 2016 році виявлення порушення зайняло [в середньому 191 день](https://www-01.ibm.com/common/ssi/cgi-bin/ssialias?htmlfid=SEL03130WWEN), тож достатньо часу для заподіяння шкоди .

*Випадок зловживання:*

Як зловмисник я атакую організацію, а журнали, системи моніторингу та команди не бачать і не реагують на мої атаки.

## Джерела схем

Усі фігури було створено за допомогою сайту <https://www.draw.io/> та експортовано (як зображення PNG) для інтеграції в цю статтю.

Усі файли XML-дескрипторів для кожної схеми доступні нижче (використовуючи опис XML, модифікація схеми можлива за допомогою сайту DRAW.IO):

[Архів дескрипторів схем](../assets/Abuse_Case_Cheat_Sheet_SchemaBundle.zip)