| Ідентифікатор та назва атаки (вразливості)                                       | Вимога (FR,NFR)                                                                                                                                              |Приклад вразливостей, які може використовувати атака|Приклад запобігання успішної реалізації атаки|
|----------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------|--------------|
| A06:2010 – Security Misconfiguration (NEW) |                                                                                                                                                              |Веб-додатки покладаються на безпечну основу. Подумайте про всі місця, куди йде ваш вихідний код. Безпека не повинна вимагати секретного вихідного коду. Чи секретний ваш вихідний код? Усі облікові дані мають бути змінені під час виробництва CM має поширюватися на всі частини програми. Встановіть бекдор через відсутній патч ОС або сервера. Експлойт недоліків XSS через відсутність патчів фреймворку програми. Неавторизований доступ до облікових записів за замовчуванням, функцій або даних програми, aбо невикористані, але доступні функції через погану конфігурацію сервера | Перевірте керування конфігурацією вашої системи. Керівництво щодо «зміцнення» безпечної конфігурації. Автоматизація тут ДІЙСНО КОРИСНА. Має охоплювати всю платформу та програму. Слідкуйте за патчами для ВСІХ компонентів. Сюди входять бібліотеки програмного забезпечення, а не лише програми ОС і сервера. Аналізуйте вплив змін на безпеку. Чи можете ви «скинути» конфігурацію програми. Вбудуйте звітність у свій процес. Якщо ви не можете підтвердити це, це небезпечно. Перевірте виконання. Сканування знаходить загальну конфігурацію та проблеми з відсутніми виправленнями |
| A07:2010 – Insecure Cryptographic Storage                               | FR1. Функція шифрування в застосунку                                                                                                                         | Ненадійне зберігання конфіденційних даних. Зловмисники отримують доступ або змінюють конфіденційну або приватну інформацію, наприклад кредитні картки, медичні записи, фінансові дані (ваші або ваших клієнтів). Зловмисники витягують секрети для використання в додаткових атаках. Збентеження компанії, невдоволення клієнтів і втрата довіри. Витрати на прибирання інциденту, такі як криміналістика, надсилання листів з вибаченнями, перевипуск тисяч кредитних карток, страхування від крадіжки особистих даних. На бізнес подають до суду та/або штрафують | Перевірте свою архітектуру. Визначте всі конфіденційні дані. Визначте всі місця, де зберігаються дані. Переконайтеся, що модель загроз враховує можливі атаки. Використовуйте шифрування для протидії загрозам, а не просто «шифруйте» дані. Захистіть відповідними механізмами. Шифрування файлів, шифрування бази даних, шифрування елементів даних Використовуйте механізми правильно. Використовуйте стандартні сильні алгоритми. Правильно генеруйте, розповсюджуйте та захищайте ключі. Будьте готові до зміни ключа Перевірте впровадження. Використовується стандартний сильний алгоритм, і це правильний алгоритм для цієї ситуації. Усі ключі, сертифікати та паролі належним чином зберігаються та захищені. Є безпечне розповсюдження ключів і дієвий план зміни ключів. Проаналізуйте код шифрування на наявність типових недоліків | 
| A08:2010 – Failure to Restrict URL Access                | FR3. Функція обмеження доступу до URL-адреси                                                                                                                 | Як захистити доступ до URL-адрес (сторінок)? Це частина забезпечення належної «авторизації», а також A4 – незахищені прямі посилання на об’єкти. Відображаються лише авторизовані посилання та пункти меню. Це називається керуванням доступом до рівня презентації та не працює. Зловмисник просто підробляє прямий доступ до «неавторизованих» сторінок. Поширена помилка... Зловмисники викликають функції та служби, для яких вони не авторизовані. Доступ до облікових записів і даних інших користувачів. Виконання привілейованих дій. | Для кожної URL-адреси сайт повинен виконувати 3 дії. Обмежити доступ автентифікованим користувачам (якщо не публічно). Примусово застосовувати будь-які дозволи на основі користувачів або ролей (якщо приватні). Повністю заборонити запити до несанкціонованих типів сторінок (наприклад, файлів конфігурації, файлів журналу, вихідних файлів тощо). Перевірте свою архітектуру. Використовуйте просту позитивну модель на кожному шарі. Переконайтеся, що у вас дійсно є механізм на кожному рівні Перевірте реалізацію. Забудьте про підходи до автоматизованого аналізу. Переконайтеся, що кожна URL-адреса у вашій програмі захищена або зовнішнім фільтром, наприклад Java EE web.xml, або комерційним продуктом, або внутрішніми перевірками у ВАШОМУ коді – скористайтеся методом isAuthorizedForURL() ESAPI. Переконайтеся, що конфігурація сервера забороняє запити до неавторизованих типів файлів. Використовуйте WebScarab або свій браузер для підробки несанкціонованих запитів | 
| A09:2010 – Insufficient Transport Layer Protection                             | FR1. Функція ідентифікації в застосунку </br> FR3. Функція перегляду списку придбань користувача </br> FR4. Функція заповнення користувачем нового придбання | Небезпечна передача конфіденційних даних. Нездатність ідентифікувати всі конфіденційні дані. Не вдалося визначити всі місця, куди надсилаються ці конфіденційні дані. В Інтернеті, до серверних баз даних, для ділових партнерів, внутрішніх комунікацій. Відсутність належного захисту цих даних у будь-якому місці. Типові зловмисники Impact отримують доступ або змінюють конфіденційну чи особисту інформацію. наприклад, кредитні картки, медичні записи, фінансові дані (ваші або ваших клієнтів). Зловмисники витягують секрети для використання в додаткових атаках. Збентеження компанії, невдоволення клієнтів і втрата довіри. Витрати на ліквідацію інциденту. На бізнес подають до суду та/або штрафують | Захистити відповідними механізмами. Використовуйте TLS для всіх з’єднань із конфіденційними даними. Індивідуальне шифрування повідомлень перед передачею. Наприклад, XML-шифрування. Підписуйте повідомлення перед передачею. Наприклад, XML-підпис. Використовуйте механізми правильно. Використовуйте стандартні сильні алгоритми (вимкніть старі алгоритми SSL). Правильно керуйте ключами/сертифікатами. Перевірте сертифікати SSL перед їх використанням. За потреби використовуйте перевірені механізми. Наприклад, SSL проти XML-шифрування | 
| A10:2010 – Unvalidated Redirects and Forwards (NEW)                            | FR3. Функція перегляду списку покупок користувача </br> FR7. Функція редагування корзини користувачем                                                        | Перенаправлення веб-додатків дуже поширене. І часто включайте в цільову URL-адресу надані користувачем параметри. Якщо вони не перевірені, зловмисник може надіслати жертву на сайт за власним вибором Перенаправлення (така ж передача в .NET) також є поширеним явищем. Вони внутрішньо надсилають запит на нову сторінку в тій самій програмі. Іноді параметри визначають цільову сторінку. Якщо не підтверджено, зловмисник може використовувати неперевірений. Типовий вплив. Перенаправте жертву на фішинговий або шкідливий сайт. Запит зловмисника пересилається через перевірки безпеки, що дозволяє неавторизований доступ до функцій або даних | Існує кілька варіантів: 1. Наскільки це можливо, уникайте використання переадресацій і переадресацій. 2. Якщо використовується, не включайте параметри користувача у визначення цільової URL-адреси. 3. Якщо ви «повинні» включати параметри користувача, то будь-яке. a) Перевірте кожен параметр, щоб переконатися, що він дійсний і авторизований для поточного користувача, або. b) (бажано) – використовуйте відображення на стороні сервера, щоб перекласти вибір, наданий користувачеві, з фактичною цільовою сторінкою. Поглиблений захист: для переспрямувань перевірте цільову URL-адресу після її обчислення, щоб переконатися, що вона спрямовує на авторизований зовнішній сайт. ESAPI може зробити це за вас. |
